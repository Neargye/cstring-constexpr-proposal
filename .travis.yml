os: linux # Use linux unless specified otherwise.
dist: bionic

language: cpp

jobs:
  include:
    - name: gcc-10
      os: linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-10
      env:
        - CXX_COMPILER=g++-10 CC_COMPILER=gcc-10

    - name: clang-10
      os: linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
            - sourceline: 'deb https://apt.llvm.org/bionic/ llvm-toolchain-bionic-10 main'
              key_url: 'https://apt.llvm.org/llvm-snapshot.gpg.key'
          packages:
            - g++-10-multilib # for libstdc++
            - clang-10
      env:
        - CXX_COMPILER=clang++-10 CC_COMPILER=clang-10

install:
  - export CC=${CC_COMPILER}
  - export CXX=${CXX_COMPILER}
  - JOBS=2 # Travis machines have 2 cores.

before_script:
  - rm -rf build
  - mkdir -p build
  - cd build

script:
  - cmake -G "Unix Makefiles" -DCMAKE_BUILD_TYPE=Debug ..
  - cmake --build . --config Debug -- -j${JOBS}
  - ctest --output-on-failure -C Debug -j${JOBS}
  - rm -rf ./*

notifications:
  email: false
